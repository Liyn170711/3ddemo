<!-- 
    笼罩着天空的气氛。
    相关类：
    scene.skyAtmosphere —— Cesium.SkyAtmosphere
    scene.globe —— Cesium.Globe
 -->
 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <title>Sky Atmosphere</title>
     <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /> 
     <script src="../../sm/js/jquery.min.js"></script>
    <link rel="stylesheet" href="../../../libs/cesium/Widgets/widgets.css">
    <script type="text/javascript" src="../../../libs/cesium/Cesium.js"> </script>
     <style>
         html, body, #cesiumer {
             margin: 0;
             padding: 0;
             width: 100%;
             height: 100%;
             background: #000;
             overflow: hidden;
         }
         .infoPanel {
            background: rgba(42, 42, 42, 0.8);
            padding: 4px;
            border: 1px solid #444;
            border-radius: 4px;
        }
        .infoPanel td {
            vertical-align: middle;
        }
        #toolbar {
            position: absolute;
            left: 5px;
            top: 5px;
            width: 400px;
            height: auto;
            color: #fff;
            background: rgba(42, 42, 42, 0.8);
            padding: 4px;
            border-radius: 4px;
        }
        #toolbar input {
            vertical-align: middle;
            float: left;
        }
     </style>
 </head>
 <body onload="loadViewer()">
     <div id="cesiumer"></div>
     <div id="toolbar">
        <table class="infoPanel">
            <tbody>
                <tr>
                    <td>hueShift</td>
                    <td>
                        <input id="hueShift_range" type="range" min="-1.0" max="1.0" step="0.01" value="0" onchange="hueShiftChange(this, hueShift_text)">
                    </td>
                    <td><input id="hueShift_text" value="0" onchange="hueShiftChange(this, hueShift_range)"></td>
                </tr>
                <tr>
                    <td>saturationShift</td>
                    <td>
                        <input id="saturationShift_range" type="range" min="-1.0" max="1.0" step="0.01" value="0" onchange="saturationShiftChange(this, saturationShift_text)">
                    </td>
                    <td><input id="saturationShift_text" value="0" onchange="saturationShiftChange(this, saturationShift_range)"></td>
                </tr>
                <tr>
                    <td>brightnessShift</td>
                    <td>
                        <input id="brightnessShift_range" type="range" min="-1.0" max="1.0" step="0.01" value="0" onchange="brightnessShiftChange(this, brightnessShift_text)">
                    </td>
                    <td><input id="brightnessShift_text" value="0" onchange="brightnessShiftChange(this, brightnessShift_range)"></td>
                </tr>
                <tr>
                    <td><input type="checkbox" onchange="ctrlLighting(this)"><span>Lighting</span></td>
                    <td><input type="checkbox" checked onchange="ctrlFog(this)"><span>Fog</span></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
 </body>
 <script>
    var viewer = null; // 三维视图
    var skyAtmosphere; // 天空氛围
    var globe; // 场景球体

    // The viewModel tracks the state of our mini application.
    // 天空氛围基于颜色基于HSL(Hue色调、Saturation饱和度、Lightness亮度)模型
    // H：Hue(色调)。0(或360)表示红色，120表示绿色，240表示蓝色，也可取其他数值来指定颜色。取值为：0 - 360
    // S：Saturation(饱和度)。取值为：0.0% - 100.0%
    // L：Lightness(亮度)。取值为：0.0% - 100.0%
    var viewModel = {
        hueShift: 0.0, // 色调
        saturationShift: 0.0, // 饱和度
        brightnessShift: 0.0 // 亮度
    };
    /**
    * 页面加载完成处理函数 
    */
    function loadViewer() {
        //  初始化三维视图
        viewer = new Cesium.Viewer("cesiumer",{
            infoBox: false, // 信息框
            selectionIndicator: false, // 选择指示器
            shadows: true, // 阴影
            shouldAnimate: true // 动画效果
        }); // 视图
        var scene = viewer.scene;
        skyAtmosphere = scene.skyAtmosphere; // 天空氛围
        globe = scene.globe; // 场景球体
        globe.enableLighting = false; // 禁用光照
        scene.fog.enabled = true; // 场景添加雾效果
        // 设置相机视角的位置
        var camera = viewer.camera;
        camera.setView({
            destination : Cesium.Cartesian3.fromDegrees(-75.5847, 40.0397, 1000.0),
            orientation: {
                heading : -Cesium.Math.PI_OVER_TWO,
                pitch : 0.2,
                roll : 0.0
            }
        });
    }

    /**
     * 控制是否显示光照效果
     * @param target 目标dom
     */
    function ctrlLighting(target) {
        var checked = target.checked;
        globe.enableLighting = checked;
    }

    /**
     * 控制是否显示雾效果
     * @param target 目标dom
     */
    function ctrlFog(target) {
        var checked = target.checked;
        viewer.scene.fog.enabled = checked;
    }

    /**
     * 色调改变处理方法
     * @param target 目标dom
     * @param input 输入dom
     */
    function hueShiftChange(target, input) {
        var value = target.value;
        viewModel.hueShift = value;
        input.value = value;
        changeAtmosphereValue(); // 修改天空氛围的值
    }

    /**
     * 饱和度改变处理方法
     * @param target 目标dom
     * @param input 输入dom
     */
     function saturationShiftChange(target, input) {
        var value = target.value;
        viewModel.saturationShift = value;
        input.value = value;
        changeAtmosphereValue(); // 修改天空氛围的值
    }

    /**
     * 亮度改变处理方法
     * @param target 目标dom
     * @param input 输入dom
     */
     function brightnessShiftChange(target, input) {
        var value = target.value;
        viewModel.brightnessShift = value;
        input.value = value;
        changeAtmosphereValue(); // 修改天空氛围的值
    }

    /**
     * 修改天空氛围的颜色值
     * @param name 天空氛围的属性名称
     * @param globeName 球体的属性名称
     * @param newValue 新值
     */
    function changeAtmosphereValue() {
        skyAtmosphere.hueShift = viewModel.hueShift; // 氛围色调
        globe.atmosphereHueShift= viewModel.hueShift; // 球体色调
        skyAtmosphere.saturationShift = viewModel.saturationShift; // 氛围饱和度
        globe.atmosphereSaturationShift= viewModel.saturationShift; // 球体饱和度
        skyAtmosphere.brightnessShift = viewModel.brightnessShift; // 氛围亮度
        globe.atmosphereBrightnessShift= viewModel.brightnessShift; // 球体亮度
    }
    
 </script>
 </html> 