<!-- 
    3D Tiles 摄影测量模型
    注：使用Cesium.IonResource.fromAssetId(6074)时，使用本地的Cesium.js加载不到3D Tiles
    使用https://cesiumjs.org/Cesium/Build/CesiumUnminified/Cesium.js官网上的类库可以加载到
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Photogrammetry</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /> 
    <link rel="stylesheet" href="../../../libs/cesium/Widgets/widgets.css">
    <script type="text/javascript" src="https://cesiumjs.org/Cesium/Build/CesiumUnminified/Cesium.js"> </script>
    <style>
        html, body, #cesiumer {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #cesiumer {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
    </style>
</head>
<body onload="loadViewer()">
    <div id="cesiumer"></div>
    <div style="position: absolute;left: 5px;top: 15px; background: rgba(255,255,255,0.5)">
        <input type="checkbox" checked id="showClassification" onchange="changeShowClassification(this)"><span>Show classification</span>
    </div>
</body>
<script>
    /**
     * 加载三维视图
     **/
    function loadViewer() {
        // An example of using a b3dm tilset to classify another b3dm tileset.
        var viewer = new Cesium.Viewer('cesiumer', {
            terrainProvider: Cesium.createWorldTerrain()
        });
        // A normal b3dm tileset of photogrammetry
        var tileset = new Cesium.Cesium3DTileset({
            url: Cesium.IonResource.fromAssetId(6074)
        });
        viewer.scene.primitives.add(tileset);
        viewer.zoomTo(tileset);
    }

    /**
     * 添加数据集合分类 
     **/
    function addTilesetClassifcation() {
        var classifcationTilesetUrl = '../../../SampleData/Cesium3DTiles/Classification/Photogrammetry/tileset.json';
        var classificationTileset = new Cesium.Cesium3DTileset({
            url: classifcationTilesetUrl, // 3D Tiles数据集合地址
            classificationType: Cesium.ClassificationType.CESIUM_3D_TILE // 3D Tiles分类类型
        });
        classificationTileset.style = new Cesium.Cesium3DTileStyle({
            color: 'rgba(255, 0, 0, 0.5)'
        });
        viewer.scene.primitives.add(classificationTileset);
        // The same b3dm tileset used for classification, but rendered normally for comparison.（同样的数据集合正常渲染用于与摄影测量数据集合的比较）
        var nonClassificationTileset = new Cesium.Cesium3DTileset({
            url: classifcationTilesetUrl,
            show: false // 控制是否显示
        });
        nonClassificationTileset.style = new Cesium.Cesium3DTileStyle({
            color: 'rgba(255, 0, 0, 0.5)'
        });
        viewer.scene.primitives.add(nonClassificationTileset);
    }

/**
 * 改变是否显示分类
 * @param target 目标dom
 **/
function changeShowClassification(target) {
    var checked = target.checked;
    classificationTileset.show = checked;
    nonClassificationTileset.show = !checked;
}
</script>
</html>